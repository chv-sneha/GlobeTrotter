import { useState } from 'react';
import { Link, useLocation } from 'react-router-dom';
import { Button } from '@/components/ui/button';
import { Sheet, SheetContent, SheetTrigger } from '@/components/ui/sheet';
import { Menu, X, Plane, MapPin, Calendar, Users, Settings, LogOut } from 'lucide-react';

export function Header() {
  const [isOpen, setIsOpen] = useState(false);
  const location = useLocation();
  const user = JSON.parse(localStorage.getItem('user') || 'null');

  const navigation = [
    { name: 'Dashboard', href: '/dashboard', icon: Plane },
    { name: 'Destinations', href: '/destinations', icon: MapPin },
    { name: 'Attractions', href: '/attractions', icon: MapPin },
    { name: 'My Trips', href: '/trips', icon: Calendar },
    { name: 'Community', href: '/community', icon: Users },
  ];

  const isActive = (path: string) => location.pathname === path;

  const handleLogout = () => {
    localStorage.removeItem('token');
    localStorage.removeItem('user');
    window.location.href = '/';
  };

  return (
    <header className=\"fixed top-0 left-0 right-0 z-50 bg-white/95 backdrop-blur-sm border-b border-border/40\">\n      <div className=\"container mx-auto px-4\">\n        <div className=\"flex items-center justify-between h-16\">\n          {/* Logo */}\n          <Link to=\"/\" className=\"flex items-center space-x-2 font-bold text-xl text-primary\">\n            <Plane className=\"h-6 w-6\" />\n            <span>GlobeTrotter</span>\n          </Link>\n\n          {/* Desktop Navigation */}\n          <nav className=\"hidden md:flex items-center space-x-1\">\n            {navigation.map((item) => {\n              const Icon = item.icon;\n              return (\n                <Link\n                  key={item.name}\n                  to={item.href}\n                  className={`flex items-center space-x-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${\n                    isActive(item.href)\n                      ? 'bg-primary text-primary-foreground'\n                      : 'text-muted-foreground hover:text-foreground hover:bg-muted'\n                  }`}\n                >\n                  <Icon className=\"h-4 w-4\" />\n                  <span>{item.name}</span>\n                </Link>\n              );\n            })}\n          </nav>\n\n          {/* User Menu */}\n          <div className=\"hidden md:flex items-center space-x-4\">\n            {user ? (\n              <div className=\"flex items-center space-x-3\">\n                <span className=\"text-sm text-muted-foreground\">Welcome, {user.name}</span>\n                <Button variant=\"ghost\" size=\"sm\" asChild>\n                  <Link to=\"/settings\">\n                    <Settings className=\"h-4 w-4\" />\n                  </Link>\n                </Button>\n                <Button variant=\"ghost\" size=\"sm\" onClick={handleLogout}>\n                  <LogOut className=\"h-4 w-4\" />\n                </Button>\n              </div>\n            ) : (\n              <div className=\"flex items-center space-x-2\">\n                <Button variant=\"ghost\" size=\"sm\" asChild>\n                  <Link to=\"/login\">Sign In</Link>\n                </Button>\n                <Button size=\"sm\" asChild>\n                  <Link to=\"/register\">Sign Up</Link>\n                </Button>\n              </div>\n            )}\n          </div>\n\n          {/* Mobile Menu */}\n          <Sheet open={isOpen} onOpenChange={setIsOpen}>\n            <SheetTrigger asChild>\n              <Button variant=\"ghost\" size=\"sm\" className=\"md:hidden\">\n                <Menu className=\"h-5 w-5\" />\n              </Button>\n            </SheetTrigger>\n            <SheetContent side=\"right\" className=\"w-80\">\n              <div className=\"flex items-center justify-between mb-8\">\n                <Link to=\"/\" className=\"flex items-center space-x-2 font-bold text-xl text-primary\">\n                  <Plane className=\"h-6 w-6\" />\n                  <span>GlobeTrotter</span>\n                </Link>\n                <Button variant=\"ghost\" size=\"sm\" onClick={() => setIsOpen(false)}>\n                  <X className=\"h-5 w-5\" />\n                </Button>\n              </div>\n\n              <nav className=\"space-y-2\">\n                {navigation.map((item) => {\n                  const Icon = item.icon;\n                  return (\n                    <Link\n                      key={item.name}\n                      to={item.href}\n                      onClick={() => setIsOpen(false)}\n                      className={`flex items-center space-x-3 px-4 py-3 rounded-lg text-sm font-medium transition-colors ${\n                        isActive(item.href)\n                          ? 'bg-primary text-primary-foreground'\n                          : 'text-muted-foreground hover:text-foreground hover:bg-muted'\n                      }`}\n                    >\n                      <Icon className=\"h-5 w-5\" />\n                      <span>{item.name}</span>\n                    </Link>\n                  );\n                })}\n              </nav>\n\n              {user && (\n                <div className=\"mt-8 pt-8 border-t border-border\">\n                  <div className=\"space-y-2\">\n                    <Link\n                      to=\"/settings\"\n                      onClick={() => setIsOpen(false)}\n                      className=\"flex items-center space-x-3 px-4 py-3 rounded-lg text-sm font-medium text-muted-foreground hover:text-foreground hover:bg-muted transition-colors\"\n                    >\n                      <Settings className=\"h-5 w-5\" />\n                      <span>Settings</span>\n                    </Link>\n                    <button\n                      onClick={handleLogout}\n                      className=\"flex items-center space-x-3 px-4 py-3 rounded-lg text-sm font-medium text-muted-foreground hover:text-foreground hover:bg-muted transition-colors w-full text-left\"\n                    >\n                      <LogOut className=\"h-5 w-5\" />\n                      <span>Sign Out</span>\n                    </button>\n                  </div>\n                </div>\n              )}\n            </SheetContent>\n          </Sheet>\n        </div>\n      </div>\n    </header>\n  );\n}